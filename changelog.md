# Changelog

## [Unreleased]

### Added
- Search box clearing functionality when navigating between different command modal views
  - Clears search when selecting a provider in models view
  - Clears search when selecting a specific model
  - Clears search when selecting a space
  - Clears search when using quick actions to switch views 
- New space creation form in command modal
  - Added form interface with name, description, provider, and model fields
  - Auto-populates available models based on selected provider
  - Form validation and error handling
  - Smooth navigation with back button support
  - Removed search functionality in form view
  - Fixed "No results found" message to only show during active search
  - Improved space creation workflow from space tab
  - Fixed back button visibility in form view
- Added space editing functionality:
  - Edit button for each space in the spaces list
  - Consistent navigation with space creation flow using command modal
  - Pre-populated form for editing space details
  - Ability to update name, description, provider, and model
  - Toast notifications for success and error states
  - Proper state updates for edited spaces
- Added inline conversation title editing:
  - Direct editing of conversation titles in the conversation tab
  - Edit button appears on hover for active conversations
  - Input field with save and cancel buttons
  - Keyboard support for saving (Enter) and canceling (Escape) edits
  - Local and server-side state updates
  - Validation to prevent empty titles
  - Proper error handling
  - Enhanced BaseTab component with rightElement prop support
  - Improved user experience with inline editing vs dialog
- Added server-side active space management
  - New setActive flag in space creation API
  - Automatic active space persistence in database
  - Proper active space state handling across sessions
  - Upsert functionality to maintain single active space per user
- Modified UnifiedInput component to use Command+/ (⌘+/) hotkey instead of just /
  - Updated placeholder text to reflect the new keyboard shortcut
  - Improved user experience with more intentional input focus trigger
- Added conversation deletion functionality
  - Created DeleteConversationDialog component for confirming deletions
  - Added delete button to each conversation in the conversations list
  - Implemented server-side deleteConversation action
  - Added space history recording for conversation deletions
  - Ensured proper cache invalidation after deletion
  - Implemented automatic selection of another conversation when active one is deleted
  - Added toast notifications for user feedback
- Improved spaces list organization
  - Spaces now sorted by last updated date
  - Active space always appears at the top
  - Enhanced visual indication of active space
  - Added "Active" label to current space
  - Improved contrast and visibility of active state
  - Added spacing between space items
  - Enhanced hover effects with subtle transitions
  - Added backdrop blur and border effects
  - Improved visual hierarchy with better shadows
- Added automatic spaces list refresh
  - Command window now fetches latest spaces data when opened
  - Ensures active space is correctly reflected in UI
  - Maintains consistency between backend and frontend state
- Enhanced keyboard navigation in command modal
  - Arrow keys now navigate between search input and list items
  - Up arrow from first list item returns focus to search
  - Down arrow from search moves focus to first list item
  - Maintains natural focus flow for better user experience
  - Preserves existing keyboard shortcuts and navigation
- Improved empty state handling in spaces list
  - Added "No spaces found" message when no spaces exist
  - Moved create space button to center of empty state
  - Enhanced visibility of space creation option
  - Added proper type definitions for space active state
  - Improved user experience for first-time users
- Added keyboard back navigation in command modal
  - Backspace key now acts as back button when search is empty
  - Matches back button behavior for all navigation states
  - Handles space form, spaces list, and models views
  - Preserves search functionality when typing
- Added active provider indication
  - Matches active model styling for consistency
  - Shows active state with visual indicators
  - Added "Active" label to current provider
  - Enhanced visual feedback for active state
- Enhanced default space creation with improved welcome message
  - Added detailed welcome message with AI assistant capabilities
  - Improved onboarding experience for new users
  - Added bullet points for key features and use cases
- Implemented Redis caching with Upstash
  - Added Redis client configuration with TTL settings
  - Implemented caching for spaces, active spaces, conversations, and messages
  - Added cache invalidation on data updates
  - Added cache key generators for consistent key naming
  - Optimized API routes to check cache before database
  - Added background cache updates for better performance
  - Implemented 5-minute TTL for all cached data
  - Added proper cache invalidation on write operations
  - Enhanced response times with Redis caching
- Refactored components into smaller, more focused components following SOLID principles:
  - Extracted SpaceForm into its own component for better separation of concerns
  - Created QuickActionsList component to handle quick action items
  - Created SpacesList component to manage space selection and creation
  - Created ModelsList component to handle model and provider selection
  - Improved component reusability and maintainability
  - Enhanced type safety with proper interfaces
  - Reduced component complexity and improved readability
  - Better separation of concerns and single responsibility principle
  - Improved testability of individual components
- Added Zustand store for managing active space state globally
- Fixed space selection sync between command window and chat interface
- Implemented real-time message streaming in chat interface
  - Added proper typing for streaming response handling
  - Implemented immediate message updates during streaming
  - Added proper state management for streaming messages
  - Fixed message synchronization between streaming and database
  - Added proper error handling for failed responses
- Improved message handling in chat interface:
  - Added real-time message conversion during streaming
  - Added proper model and provider information to all messages
  - Implemented optimized message state management
  - Added proper message persistence before AI responses
  - Enhanced message type safety and validation
  - Improved streaming performance with content equality checks
  - Added proper error handling for message creation
  - Enhanced state synchronization between UI and database
  - Added automatic message extension with space metadata
  - Synchronized AI messages with extended message format
  - Added proper conversation and user context to messages
  - Improved message state management during streaming
- Updated ClientChatContent to use global space store
- Updated QuickActionsCommand to use global space store
- Improved space selection handling to maintain consistency across components
- Improved prop naming in ClientChatContent component
  - Renamed `initialActiveSpace` to `defaultSpace`
  - Renamed `initialConversations` to `defaultConversations`
  - Made prop names more concise and descriptive
- Improved initial space creation and setup flow
  - Added proper sequencing of space creation, activation, and conversation setup
  - Created welcome conversation with initial message
  - Added fallback for setting first space as active if none active
  - Improved error handling with descriptive messages
  - Added proper state refresh after initialization
  - Added proper default provider and model configuration
  - Fixed type safety for provider and model selection
- Added Suspense boundaries with skeleton loading
  - Created TabSkeleton component for navigation tabs
  - Created ChatMessagesSkeleton component for chat messages
  - Added loading states that match the visual style of the app
  - Improved perceived performance with immediate loading feedback
  - Enhanced user experience during data fetching
- Conversations list feature in quick actions command
  - Added ability to view and switch between conversations in the current space
  - Added ability to create new conversations
  - Integrated with existing space and model selection UI
  - Added conversations list component with active conversation indicator
- Added keyboard shortcuts for quick actions
  - ⌘/Ctrl + S to open spaces
  - ⌘/Ctrl + M to open models
  - ⌘/Ctrl + C to open conversations
  - Added visual keyboard shortcut hints to quick actions menu
  - Automatic platform detection for Mac/Windows key symbols
  - Styled keyboard shortcut badges with consistent design
- Enhanced quick actions with command hints
  - Added command hints (e.g., "> spaces", "> models") to each action
  - Styled hints with monospace font and subtle color
  - Combined hints with existing keyboard shortcuts
  - Improved discoverability of command-based navigation
- Created new `LLMResponseFormatter` component for efficient markdown and code block formatting
  - Highly performant implementation without external dependencies
  - Support for code block syntax highlighting
  - Markdown formatting including bold, italic, links, and lists
  - Automatic language detection for code blocks
  - Hover effects and language badges for code blocks
  - Memoized content processing for optimal performance
- Enhanced LLMResponseFormatter with comprehensive markdown support:
  - Added copy-to-clipboard functionality for code blocks
  - Added support for all header levels (H1-H3)
  - Added support for tables, blockquotes, and horizontal rules
  - Added task lists with checkbox support
  - Added definition lists and abbreviations
  - Added footnotes and improved link handling
  - Added superscript and subscript support
  - Added image support with lazy loading
  - Improved code block styling with language detection
  - Enhanced accessibility with ARIA labels and semantic HTML
  - Optimized performance with better memoization
  - Added visual feedback for code copying
  - Improved list handling and nesting
- Enhanced LLMResponseFormatter with advanced syntax highlighting:
  - Added custom lightweight syntax highlighter
  - Support for Python, JavaScript, and TypeScript
  - VS Code-like theme with carefully chosen colors
  - Language-specific token highlighting
  - Performance-optimized implementation
  - No external dependencies
  - Automatic language detection
  - Copy-to-clipboard functionality
  - Improved code block styling
  - Enhanced accessibility
  - Better visual hierarchy
- Replaced `marked` with `markdown-it` for markdown rendering
  - Improved performance and reliability
  - Better TypeScript support
  - Added syntax highlighting with highlight.js
  - Added copy button for code blocks
  - Automatic external link handling
  - Responsive typography with Tailwind's prose classes
  - Proper HTML sanitization with DOMPurify
- Implemented new markdown renderer using Marked library:
  - Added syntax highlighting with highlight.js
  - Added copy button for code blocks
  - Added target="_blank" for external links
  - Added proper sanitization with DOMPurify
  - Added support for GitHub Flavored Markdown
  - Added proper code block language detection
  - Added proper HTML sanitization
  - Added proper link handling
  - Added proper code block styling
- Implemented MarkdownRenderer component with the following features:
  - Markdown parsing using Marked library
  - Code syntax highlighting with highlight.js
  - Copy button for code blocks
  - Automatic external link handling
  - HTML sanitization with DOMPurify
  - GitHub Flavored Markdown support
  - Heading IDs and URL handling
  - Responsive design with Tailwind Typography
- Added inline code block support in markdown:
  - Added custom inline code renderer
  - Added consistent styling for inline code
  - Added proper padding and borders
  - Added monospace font and appropriate sizing
  - Added subtle background and border effects
  - Improved readability with proper spacing
  - Maintained visual consistency with code blocks
- Enhanced markdown renderer spacing using Tailwind prose modifiers for better typography and readability
  - Added consistent spacing for headings, paragraphs, lists, code blocks, and blockquotes
  - Improved vertical rhythm throughout markdown content
  - Maintained existing inline code styling while adding proper element spacing
- Enhanced pre tag styling in markdown renderer to match code block component appearance
  - Added container styling with backdrop blur and hover effects
  - Implemented consistent code formatting with 13px font size
  - Added rounded corners and border effects
  - Maintained consistent spacing and padding
- Enhanced
- Added syntax highlighting for inline code:
  - Integrated highlight.js for inline code blocks
  - Added automatic language detection
  - Maintained consistent styling with proper fallback
  - Improved error handling for highlighting failures
  - Enhanced visual consistency with code blocks
- Implemented soft delete functionality for conversations
  - Added `is_deleted` field to Conversation interface
  - Updated `deleteConversation` function to perform soft delete
  - Modified conversation retrieval functions to filter out deleted conversations
  - Enhanced cache handling to prevent serving deleted conversations
  - Set `is_deleted` to false by default in `createConversation` function
  - Created SQL migration script for database schema update
- Added conversation title editing functionality:
  - Inline editing directly in the conversations list
  - Edit button next to each conversation in the command modal
  - Keyboard shortcuts (Enter to save, Escape to cancel)
  - Visual feedback with save/cancel buttons
  - Proper focus management for improved accessibility
  - Client-side state updates for immediate feedback
  - Server-side persistence with the updateConversationTitle function
- Added improved conversation selection logic after deletion:
  - Prioritizes selecting a conversation from the same space when a conversation is deleted
  - Falls back to other spaces only if no conversations remain in the current space
  - Properly handles empty state when all conversations are deleted

### Changed
- Updated quick actions menu names to be more concise
  - Changed "Switch Space" to "Spaces"
  - Changed "Switch Model" to "Models"
- Improved keyboard shortcut styling
  - Made shortcut keys perfect squares with consistent dimensions
  - Added flex layout for better centering
  - Standardized size to 24x24 pixels
- Improved command modal response time
  - Modal now closes immediately upon selection (space or model)
  - Actions continue in background after modal closes
  - Better user experience with instant feedback
- Improved space creation process
  - Form now only requires space name to be valid
  - Default model is automatically selected
  - Modal closes immediately when creating space
  - Creation process continues in background
  - Faster and more responsive user experience 
  - No loading indicators during space creation
  - Immediate activation of newly created spaces
  - Active space persists across page refreshes
- Enhanced model selection interface
  - Added visual indication of active model
  - Consistent styling with spaces list
  - Added "Active" label to current model
  - Improved hover effects and transitions
  - Better spacing and visual hierarchy
  - Added backdrop blur and border effects
- Unified command modal item styling
  - Consistent hover effects across all items
  - Added subtle borders and transitions
  - Improved spacing and padding
  - Enhanced visual feedback on interaction
  - Standardized rounded corners
  - Added backdrop blur effect to all items
  - Smoother opacity transitions for icons 
- Updated create space button styling
  - Changed to primary action button style
  - Added hover and focus states
  - Improved visual feedback
  - Centered in footer with max width 
- Refactored API routes for better organization and consistency:
  - Centralized all constants in lib/constants.ts:
    - Database table names
    - Column names
    - Message roles
    - Error messages
    - Default values
  - Removed duplicated strings and error messages
  - Standardized error handling across all routes
  - Improved type safety with constant enums
  - Enhanced maintainability with centralized constants
  - Reduced potential for typos and inconsistencies
  - Made database operations more consistent
  - Updated all API routes to use constants:
    - Updated spaces routes
    - Updated conversations routes
    - Updated messages routes
    - Updated chat route
    - Improved error handling consistency
    - Enhanced response formatting
    - Standardized API response structure
- Extended use of constants across the application:
  - Updated quick-actions-command to use constants for:
    - Default space name and description
    - Model and provider configuration
    - Form default values
  - Updated chat component to use constants for:
    - Message roles
    - Error messages
    - Response formatting
  - Updated message component to use constants for:
    - Role definitions
    - Styling configuration
    - Error handling
  - Updated message-input to use constants for:
    - Message roles
    - Form validation
    - Error messages
  - Improved type safety with proper imports
  - Reduced code duplication
  - Enhanced maintainability
  - Standardized configuration across components
- Updated ClientChatContent to use global space store
- Updated QuickActionsCommand to use global space store
- Improved space selection handling to maintain consistency across components
- Improved prop naming in ClientChatContent component
  - Renamed `initialActiveSpace` to `defaultSpace`
  - Renamed `initialConversations` to `defaultConversations`
  - Made prop names more concise and descriptive
- Improved initial space creation and setup flow
  - Added proper sequencing of space creation, activation, and conversation setup
  - Created welcome conversation with initial message
  - Added fallback for setting first space as active if none active
  - Improved error handling with descriptive messages
  - Added proper state refresh after initialization
  - Added proper default provider and model configuration
  - Fixed type safety for provider and model selection
- Refactored ClientChatContent useEffect for better readability and maintainability:
  - Implemented early returns for better flow control
  - Simplified nested conditionals
  - Added proper error handling structure
  - Used optional chaining and nullish coalescing
  - Improved code organization with clear sections
  - Enhanced type safety with proper null checks
  - Added descriptive comments for better code clarity
- Connected SpaceTab and ModelTab components directly to Zustand store for automatic updates
- Removed prop drilling in favor of direct store connection
- Added "No Model Selected" text to ModelTab empty state
- Improved component reactivity for space and model selection changes
- Optimized space switching for better responsiveness
  - Added immediate UI updates when switching spaces
  - Set active space from local state before backend update
  - Improved perceived performance of space switching
- Refactored navigation tabs for better consistency
  - Created reusable BaseTab component
  - Unified styling across all tabs
  - Added consistent hover and active states
  - Maintained specific min-widths for each tab type
  - Improved component maintainability
- Enhanced SpaceTab visual appearance
  - Updated space icon with colorful gradient background
  - Added vibrant indigo-to-pink gradient for better visual hierarchy
  - Improved visual feedback for active spaces
- Simplified command hints in quick actions
  - Removed ">" prefix from commands
  - Shows just the command text (e.g., "spaces", "models")
  - Cleaner, more minimal command display
  - Maintained monospace font and subtle styling
- Updated quick actions command hints
  - Changed to show full command keys (e.g., "> spaces", "> models")
  - Improved visual alignment with Raycast-style command display
  - Enhanced command discoverability with consistent prefix
- Simplified quick actions display
  - Removed command text hints
  - Showing only keyboard shortcut badges
  - Cleaner, more minimal interface
  - Improved visual focus on essential elements
- Reorganized navigation layout:
  - Moved space tab to top center of screen
  - Added conversation tab to bottom navigation
  - Improved visual hierarchy with fixed positioning
  - Maintained consistent styling across all tabs
  - Added active conversation indicator
  - Kept quick actions and model tabs in bottom navigation
  - Enhanced user experience with clear navigation structure
- Improved scroll to bottom button positioning
  - Moved button to appear directly underneath space tab
  - Maintained consistent styling with space tab
  - Enhanced visual hierarchy with proper spacing
  - Improved user experience with clear button placement
- Switched from react-markdown to marked for better performance and customization
- Improved code block rendering with copy functionality
- Enhanced link handling with proper external link detection
- Improved markdown sanitization with DOMPurify
- Enhanced MarkdownRenderer with inline code support:
  - Customized markdown-it renderer for inline code
  - Added highlight function for consistent code handling
  - Added styling utilities for inline code blocks
  - Improved visual hierarchy with subtle styling
- Enhanced markdown renderer to use CodeBlock component for fenced code blocks
  - Integrated CodeBlock component for better code display
  - Maintained regular markdown rendering for non-code content
  - Improved code block styling with language detection
  - Added copy functionality for code blocks
  - Preserved sanitization for regular content
- Enhanced markdown list formatting:
  - Added preprocessing to convert strong tags to list items
  - Improved list styling with proper bullets and numbers
  - Added correct indentation for list items
  - Enhanced list item spacing and hierarchy
  - Fixed strong tag conversion for heading-like items
- Updated chat route to use dynamic current date in system prompt
  - Added getCurrentFormattedDate function for consistent date formatting
  - System prompt now shows actual current date instead of hardcoded value
  - Year references in date formatting rules are now dynamic
- Simplified conversation tab interface:
  - Removed title editing capability from conversation tab header
  - Kept editing functionality in the conversations list for better UX
  - Streamlined tab header with cleaner appearance
- Enhanced ClientChatContent component with improved data handling:
  - Added better filtering of deleted conversations from cached data
  - Improved space data loading with filtering for deleted conversations
  - Added proper handling of active conversation selection after deletion
  - Enhanced cache state management with separate cachedConversations state
- Removed conversation title editing from ConversationTab:
  - Simplified component to display conversation title without editing
  - Removed editing-related state and functions
  - Streamlined UI by removing edit button and editing interface
  - Maintained core functionality of displaying conversation and creating new ones

### Fixed
- Fixed issue with deleted conversations still appearing after page reload:
  - Corrected filtering in ClientChatContent to properly exclude deleted conversations
  - Enhanced getActiveConversation to ensure it doesn't return deleted conversations
  - Fixed cache invalidation for active conversation when a conversation is deleted
  - Improved DeleteConversationDialog to select relevant conversations after deletion
- Fixed conversation loading issues when switching between spaces:
  - Added space-aware conversation selection when deleting conversations
  - Corrected loadSpaceData function to properly filter deleted conversations
  - Enhanced error handling in conversation selection process
- Fixed issue with deleted conversations still showing in the UI until page refresh:
  - Added filtering of deleted conversations in the ConversationsList component
  - Ensured proper store updates after conversation deletion
  - Added consistent filtering of deleted conversations across all components
  - Improved sync between UI state and database state
- Improved cache invalidation when switching models:
  - Added cache clearing for all conversations in a space
  - Added cache clearing for all messages in affected conversations
  - Added cache clearing for active space and spaces list
  - Fixed issue where old model settings were persisting in cache
  - Added proper cache invalidation triggers in space update endpoint
  - Improved cache key management for model-specific data
  - Enhanced cache consistency during model switches
- Fixed BaseTab component styling regression:
  - Restored original styling while preserving rightElement functionality
  - Fixed minWidth prop to accept 'space', 'model', or 'actions' values
  - Ensured proper button positioning and spacing
  - Maintained original hover effects and transitions
  - Preserved correct text and icon coloring
- Fixed space creation form showing editing data:
  - Corrected "Create Space" action in quick actions menu to properly reset form
  - Ensured form starts with a blank slate when creating a new space
  - Fixed form state management to clear previous editing data
  - Properly reset space editing state when creating a new space

### Performance
- Optimized Redis caching implementation
- Reduced unnecessary JSON parsing operations
- Improved cache hit ratio with better invalidation strategy
- Enhanced response times for frequently accessed data
- Implemented Redis helper functions for consistent cache operations:
  - `setCache`: Handles JSON serialization and TTL setting
  - `getCache`: Handles JSON parsing and type safety
  - `deleteCache`: Handles cache invalidation
- Updated all API routes to use new cache helper functions:
  - Spaces route now uses consistent caching pattern
  - Conversations route implements proper cache invalidation
  - Messages route includes improved error handling
- Added proper error logging across all routes
- Implemented consistent error response format
- Optimized message streaming performance in chat interface:
  - Reduced unnecessary state updates during streaming
  - Added content equality checks to prevent redundant updates
  - Eliminated extra API calls after streaming completion
  - Improved state consistency during streaming
  - Enhanced error handling and null checks
  - Reduced re-renders during message streaming
  - Optimized array operations for better performance

### Deprecated

### Removed

### Security 

## [0.1.0] - 2023-XX-XX

### Added
- Initial release 